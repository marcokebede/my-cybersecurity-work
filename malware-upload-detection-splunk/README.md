Malware Upload Detection — Splunk SOC Investigation

Challenge Overview

In this challenge from a Splunk "Boss of the SOC" (BOTS) exercise,

the objective was to identify the name of the executable uploaded by the attacker known as Po1s0n1vy.

The investigation simulated a real-world incident response scenario where log analysis was required to track

suspicious behavior and determine the file involved in a potential breach.

Tools and Technologies Used

Splunk Enterprise Search (SPL): Used to query and filter massive log data efficiently.

BOTS Dataset / Scenario Logs: Provided structured and unstructured security event data, including web, endpoint, and network logs.

Knowledge of SPL (Search Processing Language): For writing precise queries that isolate attacker behavior.

Step-by-Step Investigation Process

Initial Query for Attacker Identity

Began by querying the alias "Po1s0n1vy" to determine where the actor appeared in logs:

index=* sourcetype=* "Po1s0n1vy"

Narrowed Search to File Upload Activity

Focused on suspicious file uploads using HTTP POST requests. Searched for .exe files:

index=main sourcetype=access_combined method=POST

| search uri_path=".exe" OR uri=".exe"

Searched for File Creation Events (Sysmon/Windows Logs)

Checked endpoint logs (like Sysmon) for file creation or execution:

index=sysmon sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational

| search Image="*3791.exe"

Confirmed via Filename and Context

Discovered the uploaded executable named:

3791.exe

This file was tied to Po1s0n1vy and confirmed through timestamp correlation and related event fields in the logs.

Lessons Learned

SPL enables targeted investigation across diverse logs, which is critical during incident response.

Identifying attacker-uploaded payloads is often achievable by narrowing focus to POST requests or newly created executable files.

Splunk’s rich logging context makes it ideal for threat hunting in SOC environments.

Next Steps

Practice pivoting across logs (e.g., DNS, endpoint, firewall) from a known indicator.

Automate detection of suspicious file uploads using saved searches or correlation rules.

